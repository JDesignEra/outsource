<div class="accordion md-accordion" id="accordionEx4" role="tablist" aria-multiselectable="true">
    <div class="card">

        <!-- Card header -->
        {{!-- <div class="card-header" role="tab" id="headingPortfolio4">

            <a class="collapsed" data-toggle="collapse" data-parent="#accordionEx4" href="#collapsePortfolio4"
                aria-expanded="true" aria-controls="collapsePortfolio4">

                <h2 class="mb-0 text-dark">
                    Test Images<i class="fas fa-angle-down rotate-icon"></i>
                </h2>
            </a>

        </div> --}}

        <!-- Card body -->
        <div id="collapsePortfolio4" class="collapse show" role="tabpanel" aria-labelledby="headingPortfolio4"
            data-parent="#accordionEx4">

            <div class="card-body">
                {{#if liked}}
                <div class="row justify-content-start">
                    {{#each liked}}
                    <div class="col-sm-5 col-lg-4 py-0 px-1">
                        <div class="portoflio-img-sm view overlay mb-1 rounded border-depth-2 p-0" data-toggle="modal"
                            data-target="#likedproject{{id}}">

                            <img src="/uploads/profile/{{uid}}/projects/{{id}}.png" class="h-100 lozad mx-auto d-block"
                                alt="">

                            <div id="viewproject{{id}}" onclick="viewProject({{id}})"
                                class="mask flex-center waves-effect waves-light rgba-black-strong">
                                <div
                                    class="row col-12 align-items-end justify-content-end justify-content-around p-0 h-100">

                                    <div class="row col-12 justify-content-between p-0">
                                        <h5 class="col-12 text-white text-left font-weight-bold">
                                            {{title}}
                                        </h5>
                                        <h6 style="font-size:2vh;" class="col-5 white-text text-left font-weight-bold">
                                            {{#if ../viewuser.id}}
                                            {{../viewuser.username}}
                                            {{else}}
                                            {{../user.username}}
                                            {{/if}}
                                        </h6>

                                        <h6 class="white-text text-right col-6">

                                            <i class="far fa-heart"></i>
                                            {{#if likes}}
                                            {{getNum likes}}
                                            {{else}}
                                            0
                                            {{/if}}&nbsp;

                                            <i class="fas fa-comment"></i>
                                            2
                                        </h6>
                                    </div>

                                </div>

                            </div>
                        </div>
                    </div>
                    {{/each}}
                </div>

                {{#extend 'scripts'}}

                <script src="/js/displayPortfolio.js"></script>

                {{/extend}}
                {{else}}
                <div class="row justify-content-center">
                    {{#if viewuser.id}}
                    <h1 class="my-5 py-5">This user has no liked Projects</h1>
                    {{else}}
                    <h1></h1>
                    {{/if}}
                </div>
                {{/if}}
            </div>

        </div>
    </div>
</div>

{{!-- =================================================== Modals =================================================== --}}

{{#extend 'modals'}}
{{#if liked}}
<section class="profile-modal">
    {{#each liked}}
    <!-- Portfolio Modal -->
    <div class="modal fade project" id="likedproject{{id}}" tabindex="-1" role="dialog"
        aria-labelledby="project{{id}}Label" aria-hidden="true">


        <button type="button" class="close m-2" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true" class="text-white">&times;</span>
        </button>

        <div class="modal-dialog-project modal-dialog" role="document">
            <div class="modal-content mt-5 p-0">

                <div class="modal-header">
                    <div class="col-12 row justify-content-between">
                        <div class="col-lg-3 col-sm-12 row justify-content-start pl-4">

                            <div class="col-2 align-self-center p-0 h-100">
                                <img onerror='this.src = "/img/profile/default.png"'
                                    src="/uploads/profile/{{uid}}/profilePic.png"
                                    class="white img-fluid rounded-circle lozad " alt="">
                            </div>

                            <div class="col-8 align-self-center pl-3 h-100">
                                <div class="row m-auto h-100 p-0">
                                    <h5 class="col-12 p-0 align-self-start text-left font-weight-bold">
                                        {{title}}</h5>
                                    <a href="
                                        {{#if ../viewuser}}
                                        /profile/view/{{../viewuser.id}}
                                    {{else}}
                                    /profile/view/{{../user.id}}
                                    {{/if}}
                                    ">
                                        <h6 class="col-12 p-0 align-self-end text-left">
                                            {{#if ../viewuser}}
                                            {{../viewuser.username}}
                                            {{else}}
                                            {{../user.username}}
                                            {{/if}}
                                        </h6>
                                    </a>
                                </div>

                            </div>

                        </div>

                        <div class="col-lg-2 col-sm-12 row justify-content-end px-0">
                            <div class="col-lg-8 col-sm-12 align-self-center pr-0">
                                {{#checkLiked likes ../user.id}}

                                <button onclick="unlikeProject({{id}})" id="likeButton"
                                    class="btn btn-danger btn-block btn-rounded">
                                    <i class="far fa-heart"></i> Liked
                                </button>

                                {{else}}
                                <button onclick="likeProject({{id}})" id="likeButton"
                                    class="btn btn-outline-danger btn-block btn-rounded">
                                    <i class="far fa-heart"></i> Like
                                </button>

                                {{/checkLiked}}
                            </div>
                        </div>

                    </div>
                </div>

                <div class="modal-body black p-0">
                    {{!-- ======================= Content ======================= --}}
                    <div id="contentTest" class="col-12 overflow-auto white p-4 min-vh-80">
                        <div id="realcontent" style="display:none">{{content}}</div>
                    </div>


                    {{!-- ======================= Services ======================= --}}
                    <div class="container black w-100 row justify-content-center mx-0 py-5">

                        <div class="row justify-content-center">
                            <img src="https://picsum.photos/id/659/100/" class="white img-fluid rounded-circle lozad"
                                alt="">
                            <h3 class="col-12 text-center white-text font-weight-bold my-3">
                                Services by
                                {{#if ../viewuser}}
                                {{../viewuser.username}}
                                {{else}}
                                {{../user.username}}
                                {{/if}}
                            </h3>
                        </div>
                        {{#if ../services}}
                        <div class="row col-12 justify-content-around">
                            {{#each ../services}}
                            <div class="card-body border-purple white col-lg-3 col-sm-12 rounded mx-2">
                                <div class="row justify-content-around">

                                    <div class="card">
                                        <div class="view overlay">
                                            <img class="card-img-top service-img"
                                                src="/uploads/services/{{uid}}/{{id}}.png">
                                        </div>

                                        <a class="btn-floating btn-action btn-deep-purple ml-auto mr-4 material-tooltip-sm"
                                            data-tooltip="tooltip" data-placement="top" title="View More Details"
                                            href="/services/view/{{uid}}/{{id}}">
                                            <i class="far fa-eye"></i>
                                        </a>

                                        <div class="card-body">
                                            <h4 class="card-title name" data-names="Service Title">
                                                {{name}}</h4>

                                            <hr>

                                            <p class="card-text">
                                                {{desc}}
                                            </p>
                                        </div>

                                        <div class="card-footer deep-purple accent-2 white-text text-center mt-4">
                                            <h5 class="m-0">
                                                ${{price}}
                                            </h5>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {{/each}}
                        </div>
                        {{else}}
                        <div class="row col-12 justify-content-around">
                            <h4 class="text-white my-5"> This user has no services </h4>

                        </div>
                        {{/if}}
                    </div>


                </div>

                <div class="modal-footer blue-grey lighten-5 row mx-auto justify-content-around">

                    {{!-- Comments --}}
                    <div class="col-lg-8 col-sm-12 border border-secondary rounded p-4 white">
                        <h4 class="text-center"> Comments </h4>
                        <hr class="hr-primary w-100">

                        <div class="row my-3 mx-auto">
                            <div class="col-1 p-0">
                                <img src="https://picsum.photos/100/"
                                    class="white w-100 img-fluid rounded-circle lozad " alt="">
                            </div>
                            <div class="col-10 ">
                                <h5 class="text-left h5-responsive"> John Smith &nbsp;
                                    <small class="text-muted"> 21
                                        May 2019 </small>
                                </h5>

                                <p class="text-left"> Lorem ipsum dolor sit amet, consectetur
                                    adipiscing
                                    elit, sed do eiusmod
                                    tempor incididunt ut
                                    labore et dolore magna aliqua. Ut enim ad minim veniam, quis
                                    nostrud
                                    exercitation ullamco
                                    laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure
                                    dolor in reprehenderit in
                                    voluptate velit esse cillum dolore eu fugiat nulla pariatur.
                                    Excepteur sint occaecat
                                    cupidatat non proident, sunt in culpa qui officia deserunt
                                    mollit
                                    anim id est laborum.</p>
                            </div>
                        </div>

                        <div class="row my-3 mx-auto">
                            <div class="col-1 p-0">
                                <img src="https://picsum.photos/110/"
                                    class="white w-100 img-fluid rounded-circle lozad " alt="">
                            </div>
                            <div class="col-10 ">
                                <h5 class="text-left h5-responsive"> Albert Einstein &nbsp;
                                    <small class="text-muted"> 22
                                        May 2019 </small>
                                </h5>

                                <p class="text-left"> Lorem ipsum dolor sit amet, consectetur
                                    adipiscing
                                    elit, sed do eiusmod
                                    tempor incididunt ut
                                </p>
                            </div>
                        </div>

                    </div>

                    {{!-- Details --}}

                    <div class="col-lg-3 col-sm-12 border border-secondary rounded p-4 white align-self-start">
                        <h4 class="text-center"> Details </h4>
                        <hr class="hr-primary w-100">

                        <div class="row justify-content-between">
                            <div class="col-6">
                                <p class="text-right font-weight-bold"> Last Update:</p>
                                <p class="text-right font-weight-bold"> Views: </p>
                                <p class="text-right font-weight-bold"> Likes: </p>
                                <p class="text-right font-weight-bold"> Comments: </p>
                            </div>
                            <div class="col-6">
                                <p class="text-left"> {{formatDate datePosted "DD/MM/YYYY"}}</p>
                                <p class="text-left"> {{views}}</p>
                                <p class="text-left">
                                    {{#if likes}}
                                    {{getNum likes}}
                                    {{else}}
                                    0
                                    {{/if}}</p>
                                <p class="text-left"> 2</p>
                            </div>
                        </div>
                        {{#if ../viewuser}}
                        {{else}}
                        {{!-- <div id="deleteButton" class="row justify-content-between">
                            <a data-toggle="modal" data-target="#confirmDelete{{id}}">
                                <button type="button" class="btn btn-danger justify-content-center">
                                    <i class="fas fa-trash-alt fa-lg"></i> &nbsp; Delete
                                </button>
                            </a>

                            <a href="/profile/editProject/{{id}}">
                                <button type="button" class="btn btn-success justify-content-center">
                                    <i class="fas fa-edit fa-lg"></i> &nbsp; Edit
                                </button>
                            </a>
                        </div> --}}
                        {{/if}}
                    </div>

                </div>

            </div>
        </div>



    </div>

    {{/each}}
</section>

{{#if open}}
<p id="openEvent">{{open}}</p>
{{#extend 'scripts'}}
<script>
    $(function () {
        id = $('#openEvent').html()
        $('#project' + id).modal('show')


        url = '/profile/viewProject/' + id
        $.ajax({
            url: url,
            //data: data,
            method: 'GET'
        }).then(function (response) {

            $('#viewproject' + id).attr('onclick', ``)

        }).catch(function (err) {
            console.error(err);
        });
    })
</script>
{{/extend}}
{{/if}}

{{#extend 'scripts'}}
<script>
    $("[id^=deleteButton]").on("click",
        function () {
            setTimeout(function () {
                backdrop = document.querySelectorAll('.modal-backdrop')
                backdrop[1].style.zIndex = 1060;
            }, 10)
        }
    )
</script>

<script>
    $("[id^=confirmDelete]").on('show.bs.modal', function (e) {
        idname = $(this).attr('id').toString()

        num = idname.slice((idname.length - 2), idname.length)
        $("#project" + num).modal('hide')

    })

    $("[id^=confirmDelete]").on('hide.bs.modal', function (e) {
        idname = $(this).attr('id').toString()

        num = idname.slice((idname.length - 2), idname.length)
        setTimeout(function () {
            $("#project" + num).modal('show')
            console.log("eh")
        }, 400)

    })
</script>

<script>
    function viewProject(id) {
        url = '/profile/viewProject/' + id
        $.ajax({
            url: url,
            //data: data,
            method: 'GET'
        }).then(function (response) {

            $('#viewproject' + id).attr('onclick', ``)

        }).catch(function (err) {
            console.error(err);
        });
    }
    function likeProject(id) {
        url = '/profile/like/' + id
        $.ajax({
            url: url,
            //data: data,
            method: 'GET'
        }).then(function (response) {

            $('#likeButton').addClass('btn-danger')
            $('#likeButton').removeClass('btn-outline-danger')
            $('#likeButton').html('Liked')
            $('#likeButton').attr('onclick', `unlikeProject(${id})`)

        }).catch(function (err) {
            console.error(err);
        });
    }
    function unlikeProject(id) {
        url = '/profile/unlike/' + id
        $.ajax({
            url: url,
            //data: data,
            method: 'GET'
        }).then(function (response) {

            $('#likeButton').addClass('btn-outline-danger')
            $('#likeButton').removeClass('btn-danger')
            $('#likeButton').html('Like')
            $('#likeButton').attr('onclick', `likeProject(${id})`)

        }).catch(function (err) {
            console.error(err);
        });
    }
</script>
{{/extend}}
{{/if}}
{{/extend}}